<?php
function MostrarErrores() { error_reporting(E_ALL); ini_set('display_errors', '1'); } function validarfoto($sp648637) { try { $spca195b = NULL; if (isset($sp648637) && $sp648637 != '') { $sp3bf49a = pathinfo($sp648637['name'], PATHINFO_EXTENSION); $sp3bf49a = strtolower($sp3bf49a); $sp870dd2 = ($sp3bf49a == 'jpg' or $sp3bf49a == 'jpeg' or $sp3bf49a == 'gif' or $sp3bf49a == 'png'); if ($sp870dd2) { $spca195b = md5(time() . $sp648637['name']) . '.' . $sp3bf49a; $sp3bfe4e = "D:\\UniServerZ\\www\\parcial3\\uploaded_files\\images/{$spca195b}"; if (move_uploaded_file($sp648637['tmp_name'], $sp3bfe4e)) { if ($sp3bf49a == 'jpg') { $spebafa3 = imagecreatefromjpeg($sp3bfe4e); imagejpeg($spebafa3, $sp3bfe4e, 100); imagedestroy($spebafa3); } if ($sp3bf49a == 'gif') { $spebafa3 = imagecreatefromgif($sp3bfe4e); imagegif($spebafa3, $sp3bfe4e); imagedestroy($spebafa3); } if ($sp3bf49a == 'png') { $spebafa3 = imagecreatefrompng($sp3bfe4e); imagepng($spebafa3, $sp3bfe4e); imagedestroy($spebafa3); } } } } return $spca195b; } catch (\Throwable $spbc0671) { } } function validarnumeros($sp648637) { $spfe3724 = NULL; if (preg_match('/^[0-9]*$/', $sp648637)) { $spfe3724 = true; } return $spfe3724; } function limpiezadatos($sp648637) { try { $sp73699f = array('/<script>.*<\\/script>/'); $sp648637 = preg_replace($sp73699f, '', $sp648637); $sp648637 = htmlspecialchars($sp648637); return $sp648637; } catch (\Throwable $spbc0671) { } } function LimpiarEntradas() { try { if (isset($_POST)) { foreach ($_POST as $spb637ea => $sp08694a) { $_POST[$spb637ea] = limpiezadatos($sp08694a); } } if (isset($_GET)) { foreach ($_GET as $spb637ea => $sp08694a) { $_GET[$spb637ea] = limpiezadatos($sp08694a); } } } catch (\Throwable $spbc0671) { } } function IniciarSesionSegura() { if (ini_set('session.use_only_cookies', 1) === FALSE) { $spcf2b8e = 'error'; $sp3a2819 = 'no puedo iniciar una sesion segura (ini_set)'; } $sp8fb9dd = session_get_cookie_params(); $spe78e75 = $sp8fb9dd['path']; $sp59afb1 = true; $sp8cec65 = true; $sp1fd868 = 'strict'; session_set_cookie_params(array('lifetime' => $sp8fb9dd['lifetime'], 'path' => $spe78e75, 'domain' => $_SERVER['HTTP_HOST'], 'secure' => $sp59afb1, 'httponly' => $sp8cec65, 'samesite' => $sp1fd868)); session_start(); session_regenerate_id(TRUE); } function cerrarsesion() { $_SESSION = array(); if (ini_get('session.use_cookies')) { $spcb08b2 = session_get_cookie_params(); setcookie(session_name(), '', time() - 42000, $spcb08b2['path'], $spcb08b2['domain'], $spcb08b2['secure'], $spcb08b2['httponly']); } session_destroy(); header('Location:index.php'); } function validarArchivo($sp648637) { try { $spca195b = NULL; if (isset($sp648637) && $sp648637 != '') { $sp3bf49a = pathinfo($sp648637['name'], PATHINFO_EXTENSION); $sp3bf49a = strtolower($sp3bf49a); $sp870dd2 = ($sp3bf49a == 'jpg' or $sp3bf49a == 'jpeg' or $sp3bf49a == 'gif' or $sp3bf49a == 'png' or $sp3bf49a == 'txt' or $sp3bf49a == 'doc' or $sp3bf49a == 'docx' or $sp3bf49a == 'pdf' or $sp3bf49a == 'xlsx' or $sp3bf49a == 'pptx' or $sp3bf49a == 'mp4' or $sp3bf49a == 'mp3'); if ($sp870dd2) { $spca195b = md5(time() . $sp648637['name']) . '.' . $sp3bf49a; $sp3bfe4e = "D:\\UniServerZ\\www\\parcial3\\uploaded_files\\archivos/{$spca195b}"; if (move_uploaded_file($sp648637['tmp_name'], $sp3bfe4e)) { if ($sp3bf49a == 'jpg') { $spebafa3 = imagecreatefromjpeg($sp3bfe4e); imagejpeg($spebafa3, $sp3bfe4e, 100); imagedestroy($spebafa3); } if ($sp3bf49a == 'gif') { $spebafa3 = imagecreatefromgif($sp3bfe4e); imagegif($spebafa3, $sp3bfe4e); imagedestroy($spebafa3); } if ($sp3bf49a == 'png') { $spebafa3 = imagecreatefrompng($sp3bfe4e); imagepng($spebafa3, $sp3bfe4e); imagedestroy($spebafa3); } } } } return $spca195b; } catch (\Throwable $spbc0671) { } }